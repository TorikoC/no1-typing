(function(t){function e(e){for(var n,r,i=e[0],c=e[1],l=e[2],d=0,p=[];d<i.length;d++)r=i[d],o[r]&&p.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],n=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(n=!1)}n&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var n={},o={app:0},a=[];function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=n,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},1:function(t,e){},"171c":function(t,e,s){},"1a37":function(t,e,s){"use strict";var n=s("8a4d"),o=s.n(n);o.a},"1a82":function(t,e,s){"use strict";var n=s("549d"),o=s.n(n);o.a},"1d08":function(t,e,s){},"29be":function(t,e,s){"use strict";var n=s("bb60"),o=s.n(n);o.a},"39ce":function(t,e,s){"use strict";var n=s("171c"),o=s.n(n);o.a},"3a10":function(t,e,s){},"3bf0":function(t,e,s){"use strict";var n=s("a25d"),o=s.n(n);o.a},"3c88":function(t,e,s){"use strict";var n=s("fe24"),o=s.n(n);o.a},"438e":function(t,e,s){},"4a59":function(t,e,s){},"4eb0":function(t,e,s){},"4f02":function(t,e,s){"use strict";var n=s("7d1b"),o=s.n(n);o.a},"500b":function(t,e,s){},5134:function(t,e,s){},"549d":function(t,e,s){},5570:function(t,e,s){"use strict";var n=s("c5d7"),o=s.n(n);o.a},"56d7":function(t,e,s){"use strict";s.r(e);s("ac6a"),s("456d"),s("cadf"),s("551c"),s("097d");var n=s("2b0e"),o=s("8c4f"),a=s("04e1"),r=s.n(a),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},c=[],l={name:"app",data:function(){return{theme:"theme--light"}},mounted:function(){this.$bus.$on("theme-change",this.changeTheme)},methods:{changeTheme:function(t){this.theme=t}}},u=l,d=(s("5c0b"),s("2877")),p=Object(d["a"])(u,i,c,!1,null,null,null);p.options.__file="App.vue";var h=p.exports,_=s("bc3a"),m=s.n(_),f={server:"http://35.241.200.20",apiServer:"http://35.241.200.20"},v=f,g=m.a.create({baseURL:v.apiServer});g.interceptors.response.use(function(t){return t.data},function(t){return window.alert(t.response.data.error),Promise.reject(t.response.data)});var b=g,k=s("8055"),w=s.n(k),C=w.a.connect(v.server);window.$debug&&(C.on("connect",function(){console.log("socket connected.")}),C.on("disconnect",function(t){console.log("socket disconnected",t)}));var y=C,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",class:t.theme,on:{click:t.hideDropdown}},[s("nav",{staticClass:"nav"},[s("ul",{staticClass:"nav__list"},[s("li",{staticClass:"nav__list-item"},[s("router-link",{staticClass:"nav__link",attrs:{to:"/"}},[t._v("练习")])],1),s("li",{staticClass:"nav__list-item"},[s("router-link",{staticClass:"nav__link",attrs:{to:"/rooms"}},[t._v("房间")])],1),s("li",{staticClass:"nav__list-item"},[s("router-link",{staticClass:"nav__link",attrs:{to:"/rank"}},[t._v("排行榜")])],1),s("li",{staticClass:"dropdown nav__list-item",on:{click:t.toggleDropdown}},[s("span",{staticClass:"nav__link dropdown__entry"},[t._v("帮助")]),s("ul",{staticClass:"dropdown__menu"},[s("li",{staticClass:"dropdown__item"},[s("router-link",{staticClass:"dropdown__link",attrs:{to:"/intro"}},[t._v("说明")])],1),s("span",{staticClass:"dropdown__divisor"}),s("li",{staticClass:"dropdown__item"},[s("router-link",{staticClass:"dropdown__link",attrs:{to:"/feedback"}},[t._v("反馈")])],1),s("li",{staticClass:"dropdown__item"},[s("router-link",{staticClass:"dropdown__link",attrs:{to:"/about"}},[t._v("关于本站")])],1)])])]),t.user?s("ul",{staticClass:"nav__list nav__list--right"},[s("li",{staticClass:"nav__list-item"},[s("router-link",{staticClass:"nav__link",attrs:{to:"/profile/"+t.user.username}},[t._v(t._s(t.user.username))])],1),s("li",{staticClass:"nav__list-item"},[s("a",{staticClass:"nav__link nav__link--danger",attrs:{href:"#"},on:{click:t.toLogout}},[t._v("退出")])])]):s("ul",{staticClass:"nav__list nav__list--right"},[s("li",{staticClass:"nav__list-item"},[s("router-link",{staticClass:"nav__link",attrs:{to:"/login"}},[t._v("登录")])],1)])]),s("router-view",{staticClass:"content"}),"/"===t.$route.fullPath?s("div",{staticClass:"menu content"},[s("div",{staticClass:"menu__mode"},[s("fieldset",[s("legend",[t._v("语言")]),s("label",{attrs:{for:"radio-cn"}},[t._v("简体中文")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],attrs:{type:"radio",id:"radio-cn",name:"lang",value:"cn"},domProps:{checked:t._q(t.lang,"cn")},on:{change:function(e){t.lang="cn"}}}),s("label",{attrs:{for:"radio-en"}},[t._v("English")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],attrs:{type:"radio",id:"radio-en",name:"lang",value:"en"},domProps:{checked:t._q(t.lang,"en")},on:{change:function(e){t.lang="en"}}})])]),s("div",[s("router-link",{attrs:{to:"/pratice/"+t.lang}},[t._v("练习")]),s("router-link",{attrs:{to:"/match/"+t.lang}},[t._v("匹配")])],1)]):t._e(),s("div",{staticClass:"footer"},[s("div",{staticClass:"footer__theme-selector"},[s("label",{attrs:{for:"theme"}},[t._v("主题")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.theme,expression:"theme"}],attrs:{name:"theme",id:"theme"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.theme=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"theme--light"}},[t._v("light")]),s("option",{attrs:{value:"theme--dark"}},[t._v("dark")])])])])],1)},x=[],R={watch:{theme:function(t){}},data:function(){return{lang:"en",user:window.$user?window.$user:"",theme:"theme--light"}},created:function(){this.$bus.$on("login",this.toLogin),this.$bus.$on("logout",this.toLogout)},methods:{hideDropdown:function(t){var e=document.getElementsByClassName("dropdown__menu")[0],s=document.getElementsByClassName("dropdown__entry")[0];s.classList.remove("dropdown__entry--active"),e.style.display="none"},toggleDropdown:function(t){t.stopPropagation();var e=document.getElementsByClassName("dropdown__menu")[0],s=document.getElementsByClassName("dropdown__entry")[0];"block"===e.style.display?(s.classList.remove("dropdown__entry--active"),e.style.display="none"):(s.classList.add("dropdown__entry--active"),e.style.display="block")},toLogin:function(t){var e=r()(t);localStorage.setItem("jwt",t),this.user=e,window.$user=e,this.$axios.defaults.headers.common["Authorization"]="Bearer ".concat(t)},toLogout:function(){window.$user="",this.user="",this.$axios.defaults.headers.common["Authorization"]="",localStorage.removeItem("jwt")}},destroyed:function(){this.$bus.$off("login",this.toLogin),this.$bus.$off("logout",this.toLogout)}},I=R,L=(s("4f02"),Object(d["a"])(I,$,x,!1,null,"31344621",null));L.options.__file="index.vue";var U=L.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._v("test")])},P=[],S={},O=S,j=(s("3bf0"),Object(d["a"])(O,E,P,!1,null,null,null));j.options.__file="Test.vue";var D=j.exports,B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pratice"},[s("cs-back"),t._m(0),s("div",{staticClass:"pratice__control"},[t.state!==t.WAITING||t.loadingSnippet?t._e():s("button",{staticClass:"pratice__start button",on:{click:t.toStart}},[t._v("Start")]),t.state===t.COUNTING?s("span",{staticClass:"pratice__clock"},[t._v("倒计时 "+t._s(t.clock))]):t._e(),t.state===t.ONGOING?s("span",[t._v("进行中")]):t._e()]),s("progress-view",{attrs:{users:t.users}}),s("platform-"+t.lang,{tag:"component",attrs:{disabled:t.platformDisabled,text:t.snippet.content,loading:t.loadingSnippet},on:{complete:t.toComplete,match:t.toMatch}}),t.loadingBook||t.loadingRecords?s("cs-loading"):t.state!==t.WAITING||t.fresh?t._e():s("result-view",{attrs:{record:t.record,book:t.book,bestRecords:t.bestRecords}})],1)},M=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pratice__header"},[s("h1",[t._v("练习模式")])])}],A=(s("f751"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"platform platform--cn"},[s("div",{staticClass:"platform__meta"},[s("div",{staticClass:"platform__progress"},[t._v("\n      计时器\n      "),s("span",[t._v(t._s(t._f("formatTime")(t.timer)))]),t._v("\n      速度\n      "),s("span",[t._v("\n        "+t._s(t.progress.speed)+"\n        "),s("cs-wpm")],1),t._v("\n      进度\n      "),s("span",[t._v(t._s(t.progress.percent)+"%")])])]),s("div",{staticClass:"platform__text"},[t.loading?s("cs-loading"):t._l(t.text,function(e,n){return s("span",{key:n,staticClass:"platform__char",class:{"platform__word--match":n<t.currentMatchLength,"platform__word--not-match":n>=t.currentMatchLength&&n<t.currentInputLength,"platform__next-word":n===t.currentMatchLength}},[t._v(t._s(e))])})],2),s("div",{staticClass:"platform__input",attrs:{contenteditable:"false",spellcheck:"false"}})])}),N=[],T={props:{disabled:{type:Boolean,default:!0},text:{type:String,default:""},loading:{type:Boolean,default:!0}},watch:{disabled:function(t){t?(clearInterval(this.timerHanler),this.timerHanler=null,this.elInput.setAttribute("contenteditable",!1),this.reset()):(this.timerHanler=setInterval(this.tick,1e3),this.startTime=Date.now(),this.watch(this.elInput),this.elInput.setAttribute("contenteditable",!0),this.focusEditable(this.elInput))}},data:function(){return{elInput:null,currentMatchLength:0,currentInputLength:0,timer:0,startTime:0,timerHanler:null,progress:{time:0,speed:0,percent:0}}},mounted:function(){this.init()},methods:{init:function(){this.elInput=document.getElementsByClassName("platform__input")[0]},watch:function(t){var e=this,s={attributes:!1,childList:!1,subtree:!0,characterData:!0},n=function(s,n){var o=e.text,a=t.textContent,r=e.getMatchLen(o,a),i=a.substr(0,r);t.setAttribute("data-highlight",i),e.currentMatchLength=r,e.currentInputLength=a.length,e.progress.time=Date.now()-e.startTime,e.progress.percent=(r/o.length*100).toFixed(0),e.progress.speed=(r/(e.progress.time/1e3)*60).toFixed(0),e.updateProgress(i.length===o.length),i.length===o.length&&n.disconnect()},o=new MutationObserver(n);o.observe(t,s)},tick:function(){this.timer=Date.now()-this.startTime},updateProgress:function(t){if(this.$emit("match",this.progress),t){var e={time:this.progress.time,speed:this.progress.speed};this.$emit("complete",e)}},getMatchLen:function(t,e){var s=0;while(s<t.length&&s<e.length&&t[s]===e[s])s+=1;return s},focusEditable:function(t){var e=window.getSelection(),s=document.createRange();t.innerHTML=" ",s.selectNodeContents(t),e.removeAllRanges(),e.addRange(s),document.execCommand("delete",!1,null)},reset:function(){this.progress={speed:0,percent:0,time:0},this.elInput.setAttribute("data-highlight",""),this.elInput.textContent="",this.timer=0,this.currentInputLength=0,this.currentMatchLength=0}}},G=T,q=(s("6b04"),Object(d["a"])(G,A,N,!1,null,"6e016b3c",null));q.options.__file="cn.vue";var J=q.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"platform platform--en"},[s("div",{staticClass:"platform__meta"},[s("div",{staticClass:"platform__progress"},[t._v("\n      计时器\n      "),s("span",[t._v(t._s(t._f("formatTime")(t.timer)))]),t._v("\n      速度\n      "),s("span",[t._v("\n        "+t._s(t.progress.speed)+"\n        "),s("cs-wpm")],1),t._v("\n      进度\n      "),s("span",[t._v(t._s(t.progress.percent)+"%")])])]),s("div",{staticClass:"platform__text"},[t.loading?s("cs-loading"):t._l(t.text,function(e,n){return s("span",{key:n,staticClass:"platform__char",class:{"platform__word--match":n<t.currentMatchLength,"platform__word--not-match":n>=t.currentMatchLength&&n<t.currentInputLength,"platform__next-word":n===t.currentMatchLength}},[t._v(t._s(e))])})],2),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"platform__input",class:{"platform__input--invalid":!t.inputValid},attrs:{cols:"30",rows:"10",spellcheck:"false",disabled:""},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})])},F=[],z=(s("28a5"),{props:{disabled:{type:Boolean,default:!0},text:{type:String,default:""},loading:{type:Boolean,default:!0}},watch:{disabled:function(t){t?(clearInterval(this.timerHanler),this.timerHanler=null,this.reset(),this.elInput.setAttribute("disabled",!0)):(this.timerHanler=setInterval(this.tick,1e3),this.words=this.text.split(" "),this.startTime=Date.now(),this.elInput.removeAttribute("disabled"),this.elInput.focus())},input:function(t){if(!t)return this.inputValid=!0,this.currentMatchLength=this.previouseMatchLength,void(this.currentInputLength=this.previouseMatchLength);var e=!1,s=!1,n=!1,o=t,a=o[o.length-1];" "===a?(o=o.substr(0,o.length-1),e=!0):"."===a&&(s=!0),this.currentIndex===this.words.length-1&&(n=!0);var r=this.words[this.currentIndex],i=this.getMatchLen(o,r);this.currentMatchLength=this.previouseMatchLength+i,this.currentInputLength=this.previouseMatchLength+o.length,this.inputValid=i===o.length,i===o.length&&r.length===o.length&&(e||s&&n)&&this.updateProgress(s&&n)}},data:function(){return{words:[],input:"",elInput:null,inputValid:!0,currentIndex:0,previouseMatchLength:0,currentMatchLength:0,currentInputLength:0,timer:0,startTime:0,timerHanler:null,progress:{time:0,speed:0,percent:0}}},mounted:function(){this.init()},methods:{init:function(){this.elInput=document.getElementsByClassName("platform__input")[0]},tick:function(){this.timer=Date.now()-this.startTime},updateProgress:function(t){if(this.input="",this.currentIndex+=1,this.previouseMatchLength=this.currentMatchLength,t||(this.previouseMatchLength+=1),this.progress.percent=Math.floor(this.previouseMatchLength/this.text.length*100).toFixed(1),this.progress.time=Date.now()-this.startTime,this.progress.speed=Math.floor(this.currentIndex/(this.progress.time/1e3)*60).toFixed(0),this.$emit("match",this.progress),t){var e={time:this.progress.time,speed:this.progress.speed};this.$emit("complete",e)}},getMatchLen:function(t,e){var s=0;while(s<t.length&&s<e.length&&t[s]===e[s])s+=1;return s},reset:function(){this.progress={speed:0,percent:0,time:0},this.timer=0,this.currentIndex=0,this.currentInputLength=0,this.currentMatchLength=0,this.previouseMatchLength=0}}}),V=z,W=(s("6ed8"),Object(d["a"])(V,H,F,!1,null,"13287e20",null));W.options.__file="en.vue";var Y=W.exports,K=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("dl",{staticClass:"result-view dl dl--sm"},[s("dt",[t._v("速度")]),s("dd",[t._v("\n    "+t._s(t.record.speed)+"\n    "),s("cs-wpm")],1),s("dt",[t._v("时间(分:秒)")]),s("dd",[t._v(t._s(t._f("formatTime")(t.record.time)))]),s("dt",[t._v("段落来自")]),s("dd",[s("div",{staticClass:"source"},[s("div",{staticClass:"source__cover"},[s("img",{attrs:{src:t.book.cover,alt:"source cover"}})]),s("div",{staticClass:"source__name"},[t._v("\n        "+t._s(t.book.name)+"\n        "),s("br"),s("small",[t._v("by "+t._s(t.book.author))])])])]),s("dt",[t._v("该段落的最佳记录(前十)")]),s("dd",[s("table",{staticClass:"table table--ranked"},[s("thead",[s("tr",[s("th",[t._v("速度\n            "),s("cs-wpm")],1),s("th",[t._v("用户")]),s("th",[t._v("时间")])])]),s("tbody",t._l(t.bestRecords,function(e){return s("tr",{key:e._id},[s("td",[t._v(t._s(e.speed))]),s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))])])}))])])])},Q=[],X={props:{record:{type:Object,defulat:{speed:0,time:0}},bestRecords:{type:Array,defulat:[]},book:{type:Object,defulat:{cover:"default url",name:"default name",author:"default author"}}}},Z=X,tt=(s("d877"),Object(d["a"])(Z,K,Q,!1,null,"601d6ea8",null));tt.options.__file="index.vue";var et=tt.exports,st=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.show?s("ul",{staticClass:"psview"},t._l(t.users,function(t){return s("li",{key:t.username},[s("pv-progress",{attrs:{name:t.username,percent:t.percent,speed:t.speed}})],1)})):t._e()},nt=[],ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"progress"},[s("div",{staticClass:"progress__name",attrs:{title:t.name}},[t._v(t._s(t.name))]),s("div",{staticClass:"progress__body-wrapper"},[s("div",{ref:"body",staticClass:"progress__body"},[t._v(t._s(t.percent)+"%")])]),s("span",{staticClass:"progress__speed"},[t._v("\n    "+t._s(t.speed)+"\n    "),s("cs-wpm")],1)])},at=[],rt={watch:{percent:function(t){this.body&&(this.body.style.width=t+"%",t<25?(this.body.classList.add("progress__body--low"),this.body.classList.remove("progress__body--high"),this.body.classList.remove("progress__body--middle"),this.body.classList.remove("progress__body--complete")):t<50?(this.body.classList.add("progress__body--middle"),this.body.classList.remove("progress__body--high"),this.body.classList.remove("progress__body--low"),this.body.classList.remove("progress__body--complete")):t<100?(this.body.classList.add("progress__body--high"),this.body.classList.remove("progress__body--middle"),this.body.classList.remove("progress__body--low"),this.body.classList.remove("progress__body--complete")):(this.body.classList.add("progress__body--complete"),this.body.classList.remove("progress__body--high"),this.body.classList.remove("progress__body--middle"),this.body.classList.remove("progress__body--low")))}},data:function(){return{body:null}},props:{lang:{type:String,default:"cn"},name:{type:String},percent:{},speed:{}},mounted:function(){this.body=this.$refs["body"]}},it=rt,ct=(s("1a82"),Object(d["a"])(it,ot,at,!1,null,"90083c64",null));ct.options.__file="progress.vue";var lt=ct.exports,ut={components:{pvProgress:lt},props:{show:{type:Boolean,default:!0},users:{type:Array,default:[]}}},dt=ut,pt=Object(d["a"])(dt,st,nt,!1,null,null,null);pt.options.__file="index.vue";var ht=pt.exports,_t={props:{lang:{type:String,required:!0}},components:{PlatformEn:Y,PlatformCn:J,ResultView:et,ProgressView:ht},data:function(){return{WAITING:0,COUNTING:1,ONGOING:2,state:0,clock:5,snippet:{},record:{},bestRecords:[],book:{},users:[{username:window.$user?window.$user.username:"游客",speed:0,percent:0}],fresh:!0,platformDisabled:!0,loadingBook:!1,loadingRecords:!1,loadingSnippet:!1}},mounted:function(){this.getSnippet(this.fresh)},methods:{getSnippet:function(t){var e=this;this.loadingSnippet||(this.loadingSnippet=!0,this.$axios.get("/random-snippet?lang=".concat(this.lang)).then(function(s){e.snippet=s.data[0],e.loadingSnippet=!1,t||(e.state=e.COUNTING,e.countdown())}))},toStart:function(){this.resetUsers(this.users),this.fresh?(this.state=this.COUNTING,this.countdown()):this.getSnippet(this.fresh)},toMatch:function(t){this.users[0]=Object.assign(this.users[0],t)},toComplete:function(t){this.platformDisabled=!0,this.postRecord(t),this.fresh&&(this.fresh=!1),this.clock=5,this.state=this.WAITING,this.record=t,this.getBook(this.snippet.bookId),this.getRecords(this.snippet._id)},getBook:function(t){var e=this;this.loadingBook||(this.loadingBook=!0,this.$axios.get("/books/".concat(t)).then(function(t){e.book=t.data,e.loadingBook=!1}))},getRecords:function(t){var e=this;this.loadingRecords||(this.loadingRecords=!0,this.$axios.get("/records?snippetId=".concat(t,"&lang=").concat(this.lang)).then(function(t){e.bestRecords=t.data,e.loadingRecords=!1}))},postRecord:function(t){var e=new FormData;e.append("username",window.$user?window.$user.username:"guest"),e.append("mode","pratice"),e.append("lang",this.lang),e.append("time",t.time),e.append("speed",t.speed),e.append("snippetId",this.snippet._id),this.$axios.post("/records",e)},resetUsers:function(t){this.users=t.map(function(t){return{username:t.username,speed:0,percent:0}})},countdown:function(){var t=this;this.clock-=1,this.clock>0?setTimeout(function(){t.countdown()},1e3):(this.state=this.ONGOING,this.platformDisabled=!1)}}},mt=_t,ft=(s("d080"),Object(d["a"])(mt,B,M,!1,null,"6d08fc11",null));ft.options.__file="index.vue";var vt=ft.exports,gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"match"},[s("cs-back"),s("h1",{staticClass:"match__header"},[t._v("匹配模式")]),s("progress-view",{attrs:{users:t.users}}),s("div",{staticClass:"match__control"},[s("button",{staticClass:"match__restart button",on:{click:t.toReload}},[t._v("重新匹配")]),t.clock>0?s("span",{staticClass:"match__clock"},[t._v("倒计时 "+t._s(t.clock))]):t._e()]),s("platform-"+t.lang,{tag:"component",attrs:{disabled:t.platformDisabled,text:t.snippet.content,loading:t.loadingSnippet},on:{complete:t.toComplete,match:t.toMatch}}),t.loadingBook||t.loadingRecords?s("cs-loading"):t.showResult?s("result-view",{attrs:{record:t.record,book:t.book,bestRecords:t.bestRecords}}):t._e()],1)},bt=[];s("20d6");function kt(t,e){if(t instanceof Array&&"function"===typeof e){var s=t.findIndex(e);~s&&t.splice(s,1)}}var wt=kt,Ct={props:{lang:{type:String,required:!0}},components:{PlatformEn:Y,PlatformCn:J,ProgressView:ht,ResultView:et},data:function(){return{id:"",username:window.$user?window.$user.username:"游客",socket:this.$socket,clock:999,snippet:{},record:{},bestRecords:[],book:{},showResult:!1,users:[],platformDisabled:!0,loadingBook:!1,loadingUsers:!0,loadingSnippet:!0,loadingRecords:!1,debug:!1}},mounted:function(){window.onbeforeunload=this.toLeave,this.socket.emit("match-join",this.lang,this.username),this.socket.on("match-update-clock",this.toUpdateClock),this.socket.on("match-update-id",this.toUpdateId),this.socket.on("match-update-book",this.toUpdateBook),this.socket.on("match-update-users",this.toUpdateUsers),this.socket.on("match-update-snippet",this.toUpdateSnippet),this.socket.on("match-update-progress",this.toUpdateProgress),this.socket.on("match-user-join",this.toJoinUser),this.socket.on("match-user-leave",this.toRemoveUser),this.socket.on("update-best-records",this.toUpdateBestRecords)},methods:{toUpdateId:function(t){this.id=t},toUpdateUsers:function(t){var e=this;this.users=t.map(function(t){return e.getPlainUser(t)}),this.loadingUsers=!1,window.$debug&&console.log("users loaded: ",t)},toUpdateSnippet:function(t){this.snippet=t,this.loadingSnippet=!1,window.$debug&&console.log("snippet loaded: ",t)},toUpdateClock:function(t){this.clock=t,window.$debug&&console.log("clock",t),0===this.clock&&(this.platformDisabled=!1)},toUpdateProgress:function(t){window.$debug&&console.log("update progress",t),this.users.forEach(function(e){e.username===t.username&&Object.assign(e,t)})},toJoinUser:function(t){this.users.push(this.getPlainUser(t)),window.$debug&&console.log("user join: ",t)},toRemoveUser:function(t){wt(this.users,function(e){return e.username===t}),window.$debug&&console.log("user leave: ",t)},toComplete:function(t){var e=Object.assign(t,{lang:this.lang,mode:"match",username:this.username,snippetId:this.snippet._id});this.platformDisabled=!0,this.record=t,this.showResult=!0,this.socket.emit("match-done",e),this.loadingBook=!0,this.socket.emit("match-fetch-book",this.snippet.bookId),this.loadingRecords=!0,this.socket.emit("fetch-best-records",this.snippet._id,this.lang)},toUpdateBook:function(t){this.loadingBook=!1,this.book=t},toUpdateBestRecords:function(t){this.loadingRecords=!1,this.bestRecords=t},toMatch:function(t){this.$socket.emit("match-update-progress",this.id,Object.assign(t,{username:this.username}))},toLeave:function(){this.socket.emit("match-leave",this.id,this.username)},toReload:function(){window.location.reload()},getPlainUser:function(t){return{username:t,speed:0,percent:0}}},destroyed:function(){this.toLeave(),this.socket.off("match-update-clock",this.toUpdateClock),this.socket.off("match-update-id",this.toUpdateId),this.socket.off("match-update-book",this.toUpdateBook),this.socket.off("match-update-users",this.toUpdateUsers),this.socket.off("match-update-snippet",this.toUpdateSnippet),this.socket.off("match-update-progress",this.toUpdateProgress),this.socket.off("match-user-join",this.toJoinUser),this.socket.off("match-user-leave",this.toRemoveUser),this.socket.off("update-best-records",this.toUpdateBestRecords)}},yt=Ct,$t=(s("ffe4"),Object(d["a"])(yt,gt,bt,!1,null,"c8090100",null));$t.options.__file="index.vue";var xt=$t.exports,Rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rank"},[s("cs-back"),s("h1",[t._v("排行榜")]),s("p",[t._v("Top 10")]),s("div",{staticClass:"rank__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],attrs:{name:"rank-lang",id:"rank-lang"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.lang=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"cn"}},[t._v("中文")]),s("option",{attrs:{value:"en"}},[t._v("英文")])])]),s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("用户")]),s("th",[t._v("速度\n          "),s("cs-wpm")],1),s("th",[t._v("时间")])])]),s("tbody",[t.loading?s("cs-loading"):t._l(t.records,function(e){return s("tr",{key:e._id},[s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(e.speed))]),s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))])])})],2)])],1)},It=[],Lt={watch:{lang:function(t){this.getRecords()}},data:function(){return{lang:"cn",records:[],loading:!1}},mounted:function(){this.getRecords()},methods:{getRecords:function(){var t=this;this.loading||(this.loading=!0,this.$axios.get("/records?lang=".concat(this.lang)).then(function(e){t.records=e.data,t.loading=!1}))}}},Ut=Lt,Et=(s("9964"),Object(d["a"])(Ut,Rt,It,!1,null,"588b9aa6",null));Et.options.__file="index.vue";var Pt=Et.exports,St=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"feedback"},[s("cs-back"),s("h1",[t._v("反馈")]),s("p",[t._v("感谢您的反馈。")]),s("a",{staticClass:"link link--lg",attrs:{href:"mailto:breakthroughtgw@gmail.com"}},[t._v("发送邮件")])],1)},Ot=[],jt={},Dt=jt,Bt=(s("39ce"),Object(d["a"])(Dt,St,Ot,!1,null,"6fb0171b",null));Bt.options.__file="index.vue";var Mt=Bt.exports,At=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about"},[s("cs-back"),s("h1",[t._v("关于本站")]),s("p",[t._v("happy-typer.com")]),s("p",[t._v("v0.1-beta")])],1)},Nt=[],Tt={},Gt=Tt,qt=(s("c97c"),Object(d["a"])(Gt,At,Nt,!1,null,"cb0b70f6",null));qt.options.__file="index.vue";var Jt=qt.exports,Ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"intro"},[s("cs-back"),s("h1",[t._v("介绍")]),t._m(0)],1)},Ft=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("dl",{staticClass:"dl"},[s("dt",[t._v("WPM")]),s("dd",[s("p",[t._v("Word Per Minute")]),s("p",[t._v("中文以字符为单位计算，英文以单词为单位计算。")])]),s("dt",[t._v("练习模式")]),s("dd",[s("p",[t._v("游客和登录用户都能进行。")]),s("p",[t._v('未登录用户的记录将以用户名"guest"保存。')])]),s("dt",[t._v("匹配模式")]),s("dd",[s("p",[t._v("游客和登录用户都能进行。")]),s("p",[t._v("与任意的在线用户进行匹配，自动开始。")])]),s("dt",[t._v("房间(需要登录)")]),s("dd",[t._v("用户可以创建和加入房间。")]),s("dt",[t._v("主题")]),s("dd",[t._v("目前有 light 和 dark 两种主题。")])])}],zt={},Vt=zt,Wt=(s("3c88"),Object(d["a"])(Vt,Ht,Ft,!1,null,"17a4c6b3",null));Wt.options.__file="index.vue";var Yt=Wt.exports,Kt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),t.toSubmit(e)}}},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),s("router-link",{staticClass:"link footer-link",attrs:{to:"/login"}},[t._v("登录")])],1)},Qt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("legend",[s("h1",[t._v("注册")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"username"}},[t._v("用户名")]),s("input",{attrs:{type:"text",name:"username",id:"username",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("邮箱")]),s("input",{attrs:{type:"email",name:"email",id:"email",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[t._v("密码")]),s("input",{attrs:{type:"password",name:"password",id:"password",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password2"}},[t._v("确认密码")]),s("input",{attrs:{type:"password",name:"password2",id:"password2",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}}),s("button",{staticClass:"button button--success reg-btn",attrs:{type:"submit"}},[t._v("注册")])])}],Xt={methods:{toSubmit:function(t){var e=this,s=t.target,n=new FormData(s),o=n.get("password"),a=n.get("password2");o===a?this.$axios.post("/users",n).then(function(t){e.$router.push("/login")}):alert("password not match.")}}},Zt=Xt,te=(s("d60d"),Object(d["a"])(Zt,Kt,Qt,!1,null,"7cd4ad28",null));te.options.__file="register.vue";var ee=te.exports,se=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),t.toSubmit(e)}}},[t._m(0),t._m(1),t._m(2),t._m(3),s("router-link",{staticClass:"link footer-link",attrs:{to:"/register"}},[t._v("注册")])],1)},ne=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("legend",[s("h1",[t._v("登录")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("邮箱")]),s("input",{attrs:{type:"email",name:"email",id:"email",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[t._v("密码")]),s("input",{attrs:{type:"password",name:"password",id:"password",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label"),s("button",{staticClass:"button button--success login-btn",attrs:{type:"submit"}},[t._v("登录")])])}],oe={methods:{toSubmit:function(t){var e=this,s=new FormData(t.target);this.$axios.post("/login",s).then(function(t){e.$bus.$emit("login",t.data),e.$router.push("/")})}}},ae=oe,re=(s("76d6"),Object(d["a"])(ae,se,ne,!1,null,"03b6f36a",null));re.options.__file="login.vue";var ie=re.exports,ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"profile"},[s("h1",[t._v("个人信息")]),t.loadingProfile?s("cs-loading"):s("dl",{staticClass:"dl"},[s("dt",[t._v("用户名")]),s("dd",[t._v(t._s(t.user.username))]),s("dt",[t._v("邮箱")]),s("dd",[t._v(t._s(t.user.email))]),s("dt",[t._v("注册时间")]),s("dd",[t._v(t._s(t._f("formatDate")(t.user.createdAt)))]),s("dt",{},[t._v("\n      最高记录\n      "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],attrs:{name:"lang",id:"lang"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.lang=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"cn"}},[t._v("中文")]),s("option",{attrs:{value:"en"}},[t._v("英文")])])]),s("dd",{staticClass:"profile__loading-field"},[t.loadingBestRecord?s("cs-loading"):s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("时间")]),s("th",[t._v("速度\n              "),s("cs-wpm")],1)])]),s("tbody",[s("tr",[s("td",[t._v(t._s(t._f("formatDate")(t.bestRecord.createdAt)))]),s("td",[t._v(t._s(t.bestRecord.speed))])])])])],1),s("dt",[t._v("最近记录")]),s("dd",[t.loadingRecentRecords?s("cs-loading"):s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("时间")]),s("th",[t._v("语言")]),s("th",[t._v("速度\n              "),s("cs-wpm")],1)])]),s("tbody",t._l(t.recentRecords,function(e){return s("tr",{key:e._id},[s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))]),s("td",[t._v(t._s(e.lang))]),s("td",[t._v(t._s(e.speed))])])}))])],1)])],1)},le=[],ue={watch:{lang:function(t){this.getBestRecord()}},props:{username:""},data:function(){return{lang:"cn",user:{},bestRecord:{},recentRecords:[],loadingProfile:!1,loadingBestRecord:!1,loadingRecentRecords:!1}},mounted:function(){this.getProfile(),this.getBestRecord(),this.getRecentRecords()},methods:{getBestRecord:function(){var t=this;this.loadingBestRecord||(this.loadingBestRecord=!0,this.$axios.get("/records?sort=speed|desc&limit=1&lang=".concat(this.lang,"&username=").concat(this.username)).then(function(e){t.loadingBestRecord=!1,t.bestRecord=e.data[0]}))},getRecentRecords:function(){var t=this;this.loadingRecentRecords||(this.loadingRecentRecords=!0,this.$axios.get("/records/?sort=createdAt|desc&limit=10&username=".concat(this.username)).then(function(e){t.recentRecords=e.data,t.loadingRecentRecords=!1}))},getProfile:function(){var t=this;this.loadingProfile||(this.loadingProfile,this.$axios.get("/users?username=".concat(this.username)).then(function(e){t.user=e.data[0],t.loadingProfile=!1}))}}},de=ue,pe=(s("f980"),Object(d["a"])(de,ce,le,!1,null,"7e12c263",null));pe.options.__file="index.vue";var he=pe.exports,_e=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rooms"},[s("cs-back"),s("h1",[t._v("房间列表")]),s("p",{staticClass:"room__create"},[s("router-link",{staticClass:"link",attrs:{to:"/add/room"}},[t._v("创建房间")])],1),s("table",[t._m(0),s("tbody",t._l(t.rooms,function(e){return s("tr",{key:e._id},[s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.lang))]),s("td",[t._v(t._s(e.creator))]),s("td",[t._v(t._s(e.users.length+"/"+e.userLimit))]),s("td",[s("button",{staticClass:"button button--sm",on:{click:function(s){t.toJoin(e)}}},[t._v("Join")])])])}))])],1)},me=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("名字")]),s("th",[t._v("语言")]),s("th",[t._v("创建者")]),s("th",[t._v("用户")]),s("th",[t._v("操作")])])])}],fe={data:function(){return{rooms:[]}},created:function(){this.getRooms()},beforeRouteEnter:function(t,e,s){window.$user?s():(alert("请先登录"),s(!1))},methods:{getRooms:function(){var t=this;this.$axios.get("/rooms?canJoin=true").then(function(e){t.rooms=e.data})},toJoin:function(t){t.users.length<t.userLimit&&this.$router.push("/rooms/".concat(t.lang,"/").concat(t._id))}}},ve=fe,ge=(s("9eeb"),Object(d["a"])(ve,_e,me,!1,null,"525286fa",null));ge.options.__file="index.vue";var be=ge.exports,ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"room"},[s("dl",{staticClass:"room__info"},[s("dt",[t._v("房间名")]),s("dd",[t._v(t._s(t.room.name))]),s("dt",[t._v("语言")]),s("dd",[t._v(t._s(t.room.lang))]),s("dt",[t._v("人数限制:")]),s("dd",[t._v(t._s(t.room.userLimit))]),s("dt",[t._v("状态")]),s("dd",[s("ul",{staticClass:"room__user-state"},t._l(t.users,function(e){return s("li",{key:e.username,class:e.prepared?"room__user-state--prepared":"",attrs:{title:e.prepared?"prepared":"not prepread"}},[t._v(t._s(e.username))])}))]),s("dt",[t._v("说明")]),s("dd",[t._v("所有人准备好之后, 房主可以开始.")])]),s("div",{staticClass:"room__main"},[s("cs-back"),s("div",{staticClass:"room__control"},[t.state===t.roomState.WAITING?s("div",{staticClass:"room__button"},[t.isHost?s("button",{staticClass:"button",attrs:{disabled:!t.allPrepared},on:{click:t.toStart}},[t._v("start")]):s("button",{staticClass:"button",attrs:{disabled:t.prepared},on:{click:function(e){t.toPrepare(t.username)}}},[t._v(t._s(t.prepared?"prepared":"prepare"))])]):t._e(),t.state===t.roomState.ONGOING&&t.clock>0?s("span",{staticClass:"room__clock"},[t._v("倒计时"+t._s(t.clock))]):t._e()]),s("progress-view",{attrs:{users:t.users}}),s("platform-"+t.lang,{tag:"component",attrs:{disabled:t.platformDisabled,text:t.snippet.content,loading:t.loadingSnippet},on:{complete:t.toComplete,match:t.toMatch}}),t.loadingBook||t.loadingRecords?s("cs-loading"):t.showResult?s("result-view",{attrs:{book:t.book,record:t.record,bestRecords:t.bestRecords}}):t._e()],1)])},we=[],Ce={components:{PlatformEn:Y,PlatformCn:J,ProgressView:ht,ResultView:et},computed:{isHost:function(){return this.users[0]&&this.users[0].username===this.username}},props:{id:{type:String,required:!0},lang:{type:String,required:!0}},data:function(){return{socket:this.$socket,username:window.$user?window.$user.username:"",clock:999,state:0,roomState:{WAITING:0,ONGOING:1},snippet:{},room:{},book:{},record:{},bestRecords:[],users:[],showResult:!1,platformDisabled:!0,prepared:!1,allPrepared:!0,first:!0,loading:!0,loadingBook:!1,loadingSnippet:!1,loadingRecords:!1}},mounted:function(){window.onbeforeunload=this.toLeave,this.socket.emit("test"),this.socket.on("room-update-clock",this.toUpdateClock),this.socket.on("room-update-state",this.toUpdateState),this.socket.on("room-update-snippet",this.toUpdateSnippet),this.socket.on("room-update-book",this.toUpdateBook),this.socket.on("room-update-progress",this.toUpdateProgress),this.socket.on("room-user-join",this.toJoinUser),this.socket.on("room-user-leave",this.toRemoveUser),this.socket.on("room-user-prepare",this.toPrepare),this.socket.on("update-best-records",this.toUpdateBestRecords),this.enterRoom()},destroyed:function(){this.toLeave(),this.socket.off("room-update-clock",this.toUpdateClock),this.socket.off("room-update-state",this.toUpdateState),this.socket.off("room-update-snippet",this.toUpdateSnippet),this.socket.off("room-update-book",this.toUpdateBook),this.socket.off("room-update-progress",this.toUpdateProgress),this.socket.off("room-user-join",this.toJoinUser),this.socket.off("room-user-leave",this.toRemoveUser),this.socket.off("room-user-prepare",this.toPrepare),this.socket.off("update-best-records",this.toUpdateBestRecords)},methods:{enterRoom:function(){var t=this;this.$axios.get("/rooms/".concat(this.id)).then(function(e){e.data.users.some(function(e){return e.username===t.username})||e.data.users.push({username:t.username}),t.room=e.data,t.resetUsers(e.data.users),t.socket.emit("room-join",t.id,t.username)})},toStart:function(){this.socket.emit("room-start",this.id),this.loadingSnippet=!0},toUpdateState:function(t){switch(this.state=t,t){case this.roomState.WAITING:this.prepared=!1,this.updateAllPrepared();break;case this.roomState.ONGOING:this.first&&(this.first=!1),this.resetUsers(this.users),this.showResult=!1;break}},toUpdateBook:function(t){this.loadingBook=!1,this.book=t},toPrepare:function(t){this.users.forEach(function(e){e.username===t&&(e.prepared=!0)});var e=this.username===t;e?(this.prepared=!0,this.socket.emit("room-prepare",this.id,this.username)):this.updateAllPrepared(),window.$debug&&console.log(this.username,"prepared")},toUpdateSnippet:function(t){this.snippet=t,this.loadingSnippet=!1,this.socket.emit("room-snippet-updated",this.id,this.username),window.$debug&&console.log("snippet loaded: ",t)},toUpdateClock:function(t){t<0?console.error("unexpect situation: clock < 0."):(this.clock=t,0===this.clock&&this.togglePlatformDisabled())},toUpdateProgress:function(t,e){var s=t===this.username;this.users.forEach(function(s){s.username===t&&Object.assign(s,e)}),s&&this.socket.emit("room-update-progress",this.id,t,e),window.$debug&&console.log("update progress",e)},toJoinUser:function(t){this.users.push(this.getPlainUser(t)),this.updateAllPrepared(),window.$debug&&console.log("user join: ",t)},toRemoveUser:function(t){wt(this.users,function(e){return e.username===t}),this.updateAllPrepared(),window.$debug&&console.log("user leave: ",t)},toComplete:function(t){this.record=t,this.showResult=!0,this.togglePlatformDisabled(),this.updateAllPrepared();var e=Object.assign(t,{lang:this.lang,mode:"match",username:this.username||"guest",snippetId:this.snippet._id});this.socket.emit("room-complete",this.id,this.username,e),this.loadingBook=!0,this.socket.emit("room-fetch-book",this.snippet.bookId),this.loadingRecords=!0,this.socket.emit("fetch-best-records",this.snippet._id,this.lang)},toUpdateBestRecords:function(t){this.loadingRecords=!1,this.bestRecords=t},toMatch:function(t){this.toUpdateProgress(this.username,t)},toLeave:function(){this.socket.emit("room-leave",this.id,this.username)},resetUsers:function(t){var e=this;this.users=t.map(function(t){return e.getPlainUser(t.username)})},togglePlatformDisabled:function(){this.platformDisabled=!this.platformDisabled},getPlainUser:function(t){return{username:t,speed:0,percent:0,done:!1,prepared:!1}},updateAllPrepared:function(){this.allPrepared=!this.users.slice(1).some(function(t){return!t.prepared})}}},ye=Ce,$e=(s("81be"),Object(d["a"])(ye,ke,we,!1,null,"c864bfb4",null));$e.options.__file="index.vue";var xe=$e.exports,Re=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"add-room form",on:{submit:function(e){return e.preventDefault(),t.toSubmit(e)}}},[s("cs-back"),s("legend",[s("h1",[t._v("创建房间")]),t._m(0),t._m(1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"user-limit"}},[t._v("人数限制")]),s("select",{attrs:{name:"userLimit",id:"user-limit"}},t._l(10,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}))]),t._m(2)])],1)},Ie=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v("名字")]),s("input",{attrs:{type:"text",id:"name",name:"name",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"lang"}},[t._v("语言")]),s("select",{attrs:{name:"lang",id:"lang",required:""}},[s("option",{attrs:{value:"en"}},[t._v("英文")]),s("option",{attrs:{value:"cn"}},[t._v("中文")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}}),s("button",{staticClass:"button",attrs:{type:"submit"}},[t._v("创建")])])}],Le=(s("a481"),{methods:{toSubmit:function(t){var e=this,s=new FormData(t.target);this.$axios.post("/rooms",s).then(function(t){e.$router.replace("/rooms/".concat(t.data.lang,"/").concat(t.data._id))})}}}),Ue=Le,Ee=(s("1a37"),Object(d["a"])(Ue,Re,Ie,!1,null,"623798a3",null));Ee.options.__file="index.vue";var Pe=Ee.exports,Se=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("nav",{staticClass:"nav"},[s("ul",[s("li",[s("router-link",{attrs:{to:"/admin/books"}},[t._v("书籍")])],1),s("li",[s("router-link",{attrs:{to:"/admin/snippets"}},[t._v("段落")])],1),s("li",[s("router-link",{attrs:{to:"/admin/users"}},[t._v("用户")])],1),s("li",{staticClass:"nav-link--right"},[s("router-link",{attrs:{to:"/"}},[t._v("用户主页")])],1)])]),s("router-view",{staticClass:"content"})],1)},Oe=[],je={beforeRouteEnter:function(t,e,s){window.$user&&window.$user.isAdmin?s():s(!1)}},De=je,Be=(s("a289"),Object(d["a"])(De,Se,Oe,!1,null,"17b45f1c",null));Be.options.__file="index.vue";var Me=Be.exports,Ae=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.loading?t._e():s("div",{staticClass:"admin-books"},[s("h1",[t._v("书籍")]),s("h2",[t._v("添加书籍")]),s("form",{staticClass:"book-form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4)]),s("h2",[t._v("书籍列表")]),s("table",[t._m(5),s("tbody",t._l(t.books,function(e,n){return s("tr",{key:e._id},[s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.author))]),s("td",[s("a",{attrs:{href:e.cover,target:"_blank"}},[t._v("封面")])]),s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))]),s("td",[s("button",{on:{click:function(s){t.del(e._id,n)}}},[t._v("删除")])])])}))])])},Ne=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v("书名:")]),s("input",{attrs:{type:"text",name:"name",id:"name",required:"",autofocus:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"author"}},[t._v("作者:")]),s("input",{attrs:{type:"text",name:"author",id:"author",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"cover"}},[t._v("封面")]),s("input",{attrs:{type:"text",name:"cover",id:"cover"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"isbn"}},[t._v("isbn(optional)")]),s("input",{attrs:{type:"text",name:"isbn",id:"isbn"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}}),s("button",{attrs:{type:"submit"}},[t._v("提交")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("名字")]),s("th",[t._v("作者")]),s("th",[t._v("封面")]),s("th",[t._v("创建时间")]),s("th")])])}],Te={data:function(){return{loading:!0,books:[]}},mounted:function(){this.getBooks()},methods:{submit:function(t){var e=this,s=new FormData(t.target);this.$axios.post("/books",s).then(function(t){e.books.push(t.data)})},getBooks:function(){var t=this;this.$axios.get("/books").then(function(e){t.books=e.data,t.loading=!1})},del:function(t,e){var s=this;this.$axios.delete("/books/".concat(t)).then(function(t){s.books.splice(e,1)})}}},Ge=Te,qe=(s("80dd"),Object(d["a"])(Ge,Ae,Ne,!1,null,"1aa39376",null));qe.options.__file="index.vue";var Je=qe.exports,He=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.loading?t._e():s("div",{staticClass:"admin-snippet"},[s("h1",[t._v("段落")]),s("P",[t._v("在这里对段落进行管理")]),s("h2",[t._v("添加段落")]),s("form",{staticClass:"snippet-form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"book-name"}},[t._v("书名:")]),s("select",{attrs:{name:"bookId",id:"book-name",required:""}},t._l(t.books,function(e){return s("option",{key:e._id,domProps:{value:e._id}},[t._v(t._s(e.name))])}))]),t._m(0),t._m(1),t._m(2)]),s("h2",[t._v("段落列表")]),s("table",[t._m(3),s("tbody",t._l(t.snippets,function(e,n){return s("tr",{key:e._id},[s("td",[t._v(t._s(e.bookId))]),s("td",[t._v(t._s(e.lang))]),s("td",{attrs:{title:e.content}},[t._v(t._s(e.content))]),s("td",[t._v(t._s(e.length))]),s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))]),s("td",[s("button",{on:{click:function(e){t.detailIndex=n}}},[t._v("详情")]),s("button",{on:{click:function(s){t.del(e._id,n)}}},[t._v("删除")])])])}))]),s("h2",[t._v("段落详情")]),t.snippets[t.detailIndex]?s("div",[s("dl",[s("dt",[t._v("书ID")]),s("dd",[t._v(t._s(t.snippets[t.detailIndex].bookId))]),s("dt",[t._v("语言")]),s("dd",[t._v(t._s(t.snippets[t.detailIndex].lang))]),s("dt",[t._v("内容")]),s("dd",[t._v(t._s(t.snippets[t.detailIndex].content))]),s("dt",[t._v("长度")]),s("dd",[t._v(t._s(t.snippets[t.detailIndex].length))]),s("dt",[t._v("创建时间")]),s("dd",[t._v(t._s(t._f("formatDate")(t.snippets[t.detailIndex].createdAt)))])])]):t._e()],1)},Fe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"lang"}},[t._v("语言")]),s("select",{attrs:{name:"lang",id:"lang",required:""}},[s("option",{attrs:{value:"cn"}},[t._v("中文")]),s("option",{attrs:{value:"en"}},[t._v("英文")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"content"}},[t._v("内容:")]),s("textarea",{attrs:{name:"content",id:"content",cols:"30",rows:"10",required:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}}),s("button",{staticClass:"snippet-form__button",attrs:{type:"submit"}},[t._v("添加")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("Book Id")]),s("th",[t._v("语言")]),s("th",[t._v("内容")]),s("th",[t._v("长度")]),s("th",[t._v("创建时间")]),s("th")])])}],ze={watch:{type:function(t){this.getBooks()}},data:function(){return{loading:!0,books:[],detailIndex:0,snippets:[]}},mounted:function(){this.getBooks(),this.getSnippets()},methods:{submit:function(t){var e=this,s=new FormData(t.target);s.append("length",s.get("content").length),this.$axios.post("/snippets",s).then(function(s){e.snippets.push(s.data),t.target.reset()})},getBooks:function(){var t=this;this.$axios.get("/books").then(function(e){t.books=e.data})},getSnippets:function(){var t=this;this.$axios.get("/snippets").then(function(e){t.snippets=e.data,t.loading=!1})},del:function(t,e){var s=this;this.$axios.delete("/snippets/".concat(t)).then(function(){s.snippets.splice(e,1)})}}},Ve=ze,We=(s("bd09"),Object(d["a"])(Ve,He,Fe,!1,null,"38e352b1",null));We.options.__file="index.vue";var Ye=We.exports,Ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"admin-users"},[s("h1",[t._v("Users")]),s("table",{staticClass:"table"},[t._m(0),s("tbody",t._l(t.users,function(e){return s("tr",{key:e.username},[s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(e.email))]),s("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))]),s("td"),s("td",[t._v(t._s(t._f("formatDate")(e.lastLoginTime)))]),s("td",[t._v(t._s(e.lastLoginIp))]),s("td",[s("button",{staticClass:"button button--danger",on:{click:function(s){s.preventDefault(),t.toDel(e._id)}}},[t._v("Del")])])])}))])])},Qe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("Username")]),s("th",[t._v("Email")]),s("th",[t._v("Join Date")]),s("th",[t._v("Play Count")]),s("th",[t._v("Last login")]),s("th",[t._v("Last login ip")]),s("th",[t._v("Action")])])])}],Xe={data:function(){return{users:[],deleting:!1}},created:function(){this.getUsers()},methods:{getUsers:function(){var t=this;this.$axios.get("/users").then(function(e){t.users=e.data})},toDel:function(t){var e=this;this.deleting||(this.deleting=!0,this.$axios.delete("/users/".concat(t)).then(function(s){e.deleting=!1;var n=e.users.findIndex(function(e){return e._id===t});~n&&e.users.splice(n,1)}))}}},Ze=Xe,ts=(s("ef0f"),Object(d["a"])(Ze,Ke,Qe,!1,null,"3a4c62e6",null));ts.options.__file="index.vue";var es=ts.exports,ss=new o["a"]({mode:"history",routes:[{path:"/",component:U,children:[{path:"test",component:D},{path:"pratice/:lang",props:!0,component:vt},{path:"match/:lang",props:!0,component:xt},{path:"rank",component:Pt},{path:"feedback",component:Mt},{path:"about",component:Jt},{path:"rooms",component:be},{path:"rooms/:lang/:id",props:!0,component:xe},{path:"add/room",component:Pe},{path:"profile/:username",props:!0,component:he},{path:"register",component:ee},{path:"login",component:ie},{path:"intro",component:Yt}]},{path:"/admin",component:Me,redirect:"/admin/snippets",children:[{path:"books",component:Je},{path:"snippets",component:Ye},{path:"users",component:es}]}]}),ns=ss;function os(t){var e="",s=Math.floor(t/1e3),n=Math.floor(s/60);return s%=60,n<10&&(n="0"+n),s<10&&(s="0"+s),e="".concat(n,":").concat(s),e}var as=os;function rs(t){var e=new Date(t),s=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),a=e.getHours(),r=e.getMinutes();n<10&&(n="0"+n),o<10&&(o="0"+o),a<10&&(a="0"+a),r<10&&(r="0"+r);var i="".concat(s,"-").concat(n,"-").concat(o," ").concat(a,":").concat(r);return i}var is=rs,cs={formatTime:as,formatDate:is},ls=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"prev-link link",on:{click:function(e){e.preventDefault(),t.$router.go(-1)}}},[t._v("← 返回")])},us=[],ds={},ps=ds,hs=Object(d["a"])(ps,ls,us,!1,null,null,null);hs.options.__file="back.vue";var _s=hs.exports,ms=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"no-data"},[t._v(t._s(t.msg))])},fs=[],vs={props:{msg:{type:String,default:"没有数据"}}},gs=vs,bs=(s("5570"),Object(d["a"])(gs,ms,fs,!1,null,"ac5de7fa",null));bs.options.__file="no-data.vue";var ks=bs.exports,ws=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("svg",{staticClass:"loading",attrs:{"aria-hidden":"true","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[s("path",{attrs:{fill:"#666",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})])},Cs=[],ys={},$s=ys,xs=(s("656a"),Object(d["a"])($s,ws,Cs,!1,null,"18b299ba",null));xs.options.__file="loading.vue";var Rs=xs.exports,Is=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Ls=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"wpm"},[t._v("\n  wpm\n  "),s("span",{staticClass:"wpm__tooltip"},[t._v("中文按字符计算, 英文按单词计算.")])])}],Us={},Es=Us,Ps=(s("80e5"),Object(d["a"])(Es,Is,Ls,!1,null,"bac2a094",null));Ps.options.__file="wpm.vue";var Ss=Ps.exports,Os=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"button",attrs:{type:t.type}},[t._v(t._s(t.msg))])},js=[],Ds={props:{msg:{type:String,default:"button"},type:{type:String,default:""}}},Bs=Ds,Ms=(s("29be"),Object(d["a"])(Bs,Os,js,!1,null,"7a6f5cad",null));Ms.options.__file="button.vue";var As=Ms.exports,Ns={"cs-back":_s,"cs-no-data":ks,"cs-loading":Rs,"cs-wpm":Ss,"cs-button":As};if(window.$debug=!1,localStorage.getItem("jwt")){var Ts=localStorage.getItem("jwt"),Gs=r()(Ts);window.login=!0,window.$user=Gs,b.defaults.headers.common["Authorization"]="Bearer ".concat(Ts)}n["a"].config.productionTip=!1,n["a"].use(o["a"]),n["a"].prototype.$axios=b,n["a"].prototype.$bus=new n["a"],n["a"].prototype.$config=v,n["a"].prototype.$socket=y;for(var qs=Object.keys(cs),Js=0;Js<qs.length;Js++){var Hs=qs[Js];n["a"].filter(Hs,cs[Hs])}for(var Fs=Object.keys(Ns),zs=0;zs<Fs.length;zs++){var Vs=Fs[zs];n["a"].component(Vs,Ns[Vs])}new n["a"]({router:ns,render:function(t){return t(h)}}).$mount("#app")},"58b4":function(t,e,s){},"5c0b":function(t,e,s){"use strict";var n=s("5e27"),o=s.n(n);o.a},"5e27":function(t,e,s){},"619c":function(t,e,s){},"656a":function(t,e,s){"use strict";var n=s("4eb0"),o=s.n(n);o.a},"656d":function(t,e,s){},"6b04":function(t,e,s){"use strict";var n=s("d05e"),o=s.n(n);o.a},"6ed8":function(t,e,s){"use strict";var n=s("438e"),o=s.n(n);o.a},7411:function(t,e,s){},"76d6":function(t,e,s){"use strict";var n=s("7411"),o=s.n(n);o.a},"7d1b":function(t,e,s){},"80dd":function(t,e,s){"use strict";var n=s("b4e7"),o=s.n(n);o.a},"80e5":function(t,e,s){"use strict";var n=s("58b4"),o=s.n(n);o.a},"81be":function(t,e,s){"use strict";var n=s("870d"),o=s.n(n);o.a},"870d":function(t,e,s){},"8a4d":function(t,e,s){},9964:function(t,e,s){"use strict";var n=s("a07e"),o=s.n(n);o.a},"9eeb":function(t,e,s){"use strict";var n=s("3a10"),o=s.n(n);o.a},a07e:function(t,e,s){},a25d:function(t,e,s){},a289:function(t,e,s){"use strict";var n=s("656d"),o=s.n(n);o.a},ab55:function(t,e,s){},b4e7:function(t,e,s){},bb60:function(t,e,s){},bd09:function(t,e,s){"use strict";var n=s("619c"),o=s.n(n);o.a},c5d7:function(t,e,s){},c97c:function(t,e,s){"use strict";var n=s("ca58"),o=s.n(n);o.a},ca58:function(t,e,s){},d05e:function(t,e,s){},d080:function(t,e,s){"use strict";var n=s("500b"),o=s.n(n);o.a},d60d:function(t,e,s){"use strict";var n=s("1d08"),o=s.n(n);o.a},d877:function(t,e,s){"use strict";var n=s("db48"),o=s.n(n);o.a},db48:function(t,e,s){},ef0f:function(t,e,s){"use strict";var n=s("5134"),o=s.n(n);o.a},f980:function(t,e,s){"use strict";var n=s("ab55"),o=s.n(n);o.a},fe24:function(t,e,s){},ffe4:function(t,e,s){"use strict";var n=s("4a59"),o=s.n(n);o.a}});
//# sourceMappingURL=app.f2043b0f.js.map